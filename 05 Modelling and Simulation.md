## P2

### 学习目标

1. 参与者能够陈述三种常见模拟方法的基本原理和潜在应用场景。
2. 可以解释计算流体动力学（CFD）模拟的基本概念。
3. 能够使用系统级网络方法来构建微流体系统的等效电路图。
4. 能够判断对于特定问题，系统级网络方法或经典CFD方法哪个更适合。

---

## P4

### 问题分析中的建模与仿真

1. **建模（Modelling）**：
   - 通过模拟来分析高度复杂的系统。

2. **数学描述（Mathematical description）**：
   - 问题的数学表述通常需要调整，以适应数值方法。

3. **解决问题（Solving）**：
   - 使用数值方法解方程很方便，但通常会引入数值误差。

此外，幻灯片中还包含了一个流程图，说明了从问题定义到模型验证的整个过程：
- 问题定义到建模、数学描述、解决问题，最后是后处理（Post-processing）。
- 每个步骤都包括验证（Validation）和核实（Verification）来确保模型的准确性和可靠性。

这种流程图是帮助理解在科学和工程问题中如何应用模拟技术来进行问题分析和求解的一个直观工具。

---

## P5

### 建模(Modelling)

#### 建模的方面(Aspects of modelling)

建模涉及以下几个关键方面：

1. **相关物理效应的识别(Identification of relevant physical effects)**
   - 流体流动(Fluid flow)
   - 热传递(Heat transfer)
   - 化学反应(Chemical reactions)
   - 其他可能的物理效应(...)

2. **模型几何形状和参数的确定(Determination of model geometry and parameters)**
   - 系统的形状和大小(Shape and size of system)
   - 材料特性(Material properties)
   - 其他相关参数(...)

3. **初始条件和边界条件(Initial and boundary conditions)**
   - 不当的起始或边界条件会导致无意义的结果(Improper starting/boundary conditions lead to meaningless results)

#### 解释：

1. **相关物理效应的识别**是建模的基础。它要求我们确定哪些物理过程对系统行为有显著影响，如流体动力学、热力学或化学动力学等。

2. **模型几何形状和参数的确定**涉及系统的物理特性。这包括定义系统的空间维度、形状，以及确定材料属性等关键参数。

3. **初始条件和边界条件**对模型的准确性至关重要。它们定义了系统的起始状态和边界限制，直接影响模拟结果的有效性。
   
---

## P6

4. **简化(Simplification)**
   - 哪些物理效应可以忽略？(Which physical effects can be neglected?)
   - 哪些几何特征是相关的或可以简化的？(Which geometrical features are relevant or can be simplified?)

5. **模型的数学表述(Mathematical formulation of model)**
   - 通常用偏微分方程或常微分方程表示(Usually in terms of partial differential equations or ordinary differential equations)
   - 数学表述的质量决定了数值精度(Quality of the mathematical formulation determines numeric accuracy)

#### 解释：

1. **简化**是建模过程中的关键步骤：
   - 它要求我们识别哪些物理效应对系统行为有显著影响，哪些可以忽略不计。
   - 同时，我们需要考虑系统的几何特征，确定哪些特征是必须保留的，哪些可以进行简化处理。

2. **模型的数学表述**是将物理概念转化为可计算的形式：
   - 大多数情况下，我们使用偏微分方程或常微分方程来描述系统的行为。
   - 数学表述的质量直接影响了最终模拟结果的数值精度。选择合适的数学模型和求解方法对于获得准确的模拟结果至关重要。

**适当的建模对于任何模拟方法都至关重要(Appropriate modelling is crucial for any simulation approach)**

---

## P7

### 微流体模拟方法概述(Overview of simulation approaches for microfluidics)

#### 模拟方法的主要类型

微流体系统的模拟方法主要包括以下三种：

1. **粒子方法(Particle methods)**
   - 通过单个粒子运动来自下而上地描述传输过程(Bottom-up description of transport via individual particle motion)

2. **基于网格的计算流体动力学(Mesh based Computational Fluid Dynamics, CFD)**
   - 使用偏微分方程(PDEs)描述宏观变量(p, v, ...)
   - 基于连续介质假设(Based on the continuum assumption)

3. **系统级网络模拟(System-level network simulation)**
   - 在网络离散点上对宏观变量(p, V, ...)建立方程
   - 考虑系统组件之间的相互作用(Interaction of system components)

#### 解释

1. **粒子方法**：
   - 最微观的方法，直接模拟单个粒子的运动
   - 适用于研究分子尺度的现象，如分子动力学(Molecular Dynamics)模拟

2. **基于网格的CFD**：
   - 将流体视为连续介质，使用偏微分方程描述流体行为
   - 适用于大多数微流体系统的详细流动分析

3. **系统级网络模拟**：
   - 最宏观的方法，将系统简化为互连的组件网络
   - 适用于复杂系统的整体行为分析，计算效率高

#### 方法比较

图中展示了这三种方法在时间尺度(Time scale)和长度尺度(Length scale)上的适用范围：

- 粒子方法适用于最小的时间和长度尺度
- 基于网格的CFD处于中间位置
- 系统级网络模拟适用于最大的时间和长度尺度

#### 应用举例

- **粒子方法**：模拟纳米通道中的单分子行为
- **基于网格的CFD**：分析微流控芯片中的流体流动和混合过程
- **系统级网络模拟**：优化复杂微流控系统的整体性能

---

## P8

### 流体粒子方法(Fluid particle methods)

#### 基于粒子方法的特点(Features of particle based methods)

1. **分辨单个粒子(Individual particles are resolved)**
   - 模拟中可以追踪和分析每一个单独的粒子

2. **液体动力学遵循粒子行为(Liquid dynamics follow particle behaviour)**
   - 流体的整体行为是由组成它的粒子的运动和相互作用决定的

#### 流体粒子方法的优势(Advantages of fluid particle methods)

1. **可研究非连续现象(Investigation of non-continuum phenomena)**
   - 例如：稀薄气体(rarefied gases)的行为

2. **自由表面和两相流的直接模拟(Straightforward simulation of free surfaces and two phase flows)**
   - 能够更容易地处理复杂的界面和多相流动问题

#### 常用方法(Common approaches)

1. **分子动力学(Molecular Dynamics, MD)**
   - 模拟分子尺度的粒子运动和相互作用

2. **光滑粒子流体动力学(Smoothed Particle Hydrodynamics, SPH)**
   - 使用光滑核函数来近似流体性质，适用于较大尺度的流体模拟

#### 解释

1. **分辨单个粒子**：
   - 这种方法能够捕捉到微观尺度的物理过程，特别适合研究纳米尺度的流体行为。

2. **液体动力学遵循粒子行为**：
   - 通过模拟大量粒子的运动和相互作用，可以自然地得到宏观流体行为，无需预先假设连续介质方程。

3. **非连续现象研究**：
   - 在微纳尺度或极低压力下，连续介质假设可能失效，粒子方法在这些情况下特别有优势。

4. **自由表面和两相流模拟**：
   - 粒子方法不需要显式追踪界面，因此在处理复杂几何形状和多相流动时更为直接。

5. **MD vs SPH**：
   - MD适用于纳米尺度，可以模拟分子间的相互作用。
   - SPH适用于较大尺度，将流体离散为宏观粒子，计算效率更高。

#### 应用举例

- **分子动力学(MD)**：模拟纳米通道中的水分子传输
- **光滑粒子流体动力学(SPH)**：模拟微流控芯片中的液滴形成和合并过程

---

## P9

### 粒子方法：分子动力学(MD)模拟

#### 原理(Principle)

1. **模拟单个分子或原子的物理运动(Physical movement of individual molecules or atoms is simulated)**
   - MD模拟追踪系统中每个粒子的运动轨迹

2. **通过相互作用势能描述个体之间的相互作用(Interaction between the individual entities is described by interaction potentials)**
   - 粒子间的力由预定义的势能函数计算得出

#### 应用(Applications)

1. **材料科学(Material sciences)**
   - 研究材料的微观结构和性质

2. **生物物理学和生物化学(Biophysics & Biochemistry)**
   - 研究蛋白质或DNA与其他(大)分子的相互作用(Interaction of proteins or DNA with other (macro)molecules)

#### 解释

1. **模拟原理**：
   - MD模拟通过求解牛顿运动方程来计算每个粒子的位置和速度
   - 相互作用势能决定了粒子之间的作用力，常见的包括范德华力、静电力等

2. **尺度和精度**：
   - MD模拟可以达到原子级别的精度，适用于纳米尺度的系统
   - 时间尺度通常在纳秒到微秒范围

3. **计算要求**：
   - MD模拟计算量大，通常需要高性能计算资源

#### 图片说明

图片展示了一个典型的MD模拟系统：
- 可以看到不同颜色的球体代表不同类型的原子或分子
- 这些粒子在三维空间中分布，形成复杂的结构
- 侧面的阴影可能代表粒子的运动轨迹或密度分布

#### 应用举例

1. **材料科学**：
   - 研究新型纳米材料的结构和性质
   - 模拟材料在极端条件下的行为

2. **生物物理学和生物化学**：
   - 研究蛋白质折叠过程
   - 模拟药物分子与靶蛋白的结合

---

## P10

### 平滑粒子流体动力学(SPH)

#### 原理：
1. 流体被表示为粒子，这是一种无网格方法。每个粒子代表一组分子。
2. 粒子的运动由NSE(可能是指Navier-Stokes方程)描述。
3. 每个粒子的性质受到周围邻近粒子的影响。

#### 应用：
1. 自由表面和两相流动（如雪崩模拟）
2. 固体力学（如裂纹模拟）
3. 电影动画（使用高度简化的物理模型）

#### 图示说明：
右侧的图展示了SPH方法中的核函数 $W(|r_i-r_j|, h)$，其中：
- $h$ 表示平滑长度
- $s·h$ 表示影响域的半径
- $i$ 和 $j$ 表示不同的粒子
- 蓝色点表示各个粒子
- 红色曲线显示了核函数的形状，表示粒子之间相互作用的强度

这种方法允许模拟复杂的流体行为，而不需要使用传统的网格方法。它在处理自由表面、多相流和大变形问题时特别有效。

---

## P11

### 基于网格的计算流体动力学 (CFD)

#### 原理

1. **假设流体为连续体**：
   - 在 CFD 中，流体被假设为连续的，即流体的物理性质（如速度、压力、密度等）在空间中连续变化。

2. **将流体域划分为离散单元（网格）**：
   - 流体域被分割成许多小的、离散的单元，这些单元构成了网格。每个网格单元中的流体性质被认为是均匀的。
   
3. **将控制方程转换为代数系统**：
   - 流体流动的控制方程（如纳维-斯托克斯方程）被离散化，转化为代数方程系统。这些方程通过数值方法求解。

#### 应用

- **任何涉及流体流动的工程问题**：
   - **空气动力学**：分析飞机、汽车等在空气中运动时的流体动力学行为。
   - **化学反应**：研究流体中发生的化学反应过程，模拟反应器等。
   - **其他应用**：涉及流体流动的其他领域，如环境工程、生物医学工程等。

#### 图例说明

- **自行车运动员的空气动力学分析**：上图展示了自行车运动员的空气动力学分析。图中显示了网格划分以及流场的计算结果。
- **心脏的血流模拟**：中间的图展示了心脏的血流模拟，通过网格划分和流场计算，研究心脏内部的血液流动情况。
- **复杂几何形状的网格划分**：下图展示了复杂几何形状的网格划分，这些网格单元用于计算流体在复杂形状内的流动。

---

## P12

### 计算流体动力学 (CFD)

#### 关于 CFD 的几点说明

1. **提供场变量的时空分辨率**：
   - CFD 提供速度（\(\vec{v}\)）、压力（\(p\)）、温度（\(T\)）、浓度（\(c\)）等场变量的空间和时间分辨率。
   - 模型中包含的方程数量显著影响计算工作量。

2. **依赖于控制方程的离散化**：
   - 可以采用基于网格的方法或无网格的方法（如 SPH）。
   - 可以使用各种离散化技术，例如有限体积法或有限元法。

3. **建立可行的 CFD 仿真（包括高质量网格）需要广泛的验证和确认**：
   - 设置一个工作中的 CFD 仿真需要广泛的验证和确认，以确保网格的高质量和仿真结果的准确性。

#### 应用领域

- **空气动力学**：分析飞机、汽车等在空气中运动时的流体动力学行为。
- **化学反应**：研究流体中发生的化学反应过程，模拟反应器等。
- **其他工程应用**：如环境工程、生物医学工程等领域。

---

## P13

### 系统级网络仿真（System-level network simulation）

#### 复杂系统仿真
复杂系统通常过于复杂，无法用CFD方法（计算流体动力学，Computational Fluid Dynamics）进行仿真。这是因为CFD方法在处理复杂流体流动和热传导问题时，计算量非常大且非常耗时。

#### 网络模型的使用
为了应对这一挑战，可以使用网络模型（network models）来模拟热力和液压问题（thermal and hydraulic problems），这些模型类似于电路网络模型（electric circuit network models）。具体而言，这些网络模型通过简化实际物理系统，将其表示为一系列节点和连接，从而简化计算过程，减少计算资源的消耗。

#### 示意图
右侧的示意图显示了一个类似于电路的网络模型，用于模拟复杂的流体和热力系统。图中标注了不同的压力点（P0、P1等），展示了流体在系统中的流动和压力变化情况。

---

## P14

### 电类比用于热传递和流体运输（Electric analogy for thermal and fluidic transport）

#### 流体力学和热传递与电动力学的相似性

1. **运输现象的类比**：
   - 流体力学和热传递处理的是**运输现象**（transport phenomena），这与电动力学非常相似。

2. **方程求解的挑战**：
   - 精确求解这些现象的**控制方程**（governing equations）非常具有挑战性。

3. **全局值的重要性**：
   - 通常情况下，全局值（global values），例如总流量（total volume flow）的信息就足够了，而实际的局部场变量分布（local field variables distribution）并不重要。这种方法被称为**网络模拟方法**（network simulation approach）。

#### 图示解释

1. **流体流动示意图**：
   - 图中展示了一段管道内的流体流动情况，管道内的流动方向用箭头表示。流体流动的压差（$ΔP$）与流体的电流（$I_R$）和电阻（$U_R$）形成类比关系。

2. **电类比**：
   - 压差（$ΔP$）在流体系统中类似于电压（$U_R$）在电路系统中的作用。
   - 流量（$I_R$）在流体系统中类似于电流（$I$）在电路系统中的作用。

---

## P15

### 网络仿真的原理

#### 原理

1. **从分布变量到积分量的转换**：
   - **分布变量**：在空间域内分布的变量，例如电流密度。
   - **积分量**：在特定点（节点）处的汇总变量，例如电流。

2. **离散节点处的变量类型**：
   - **跨变量**：测量跨越一个元件的变量，例如电压或压力。
   - **通变量**：通过一个元件的变量，例如电流或质量流量。

3. **转移函数的求解**：
   - 不再求解偏微分方程（PDE）系统，而是求解转移函数。
   - 转移函数通过普通微分方程（ODE）表示，适用于网络仿真。
---

## P16

### 网络仿真方法：电路

#### 方法

1. **离散理想元件替换实际系统**：
   - 电阻 \( R \)
   - 电感 \( L \)
   - 电容 \( C \)
   - 二极管 \( D \)

2. **使用守恒定律（基尔霍夫定律）将元件连接成网络**：
   - **电流定律**：在每个节点处，所有流入电流之和等于零 \(\sum I_i = 0 \)
   - **电压定律**：在任意闭合回路中，所有电压降之和等于零 \(\sum U_i = 0 \)

3. **传递函数**：
   - 连接每种元件类型的跨变量和通变量的函数。

---

## P17

![alt text](image.png)

---

## P18

### 流体阻力

#### 电-流体动力学阻力类比

- **电学**：导体中的电压损耗
- **流体动力学**：通道中的流体动力学势能损耗：
  \[
  U_{\text{hyd}} = \Delta p_{\text{tot}} = \Delta p + \rho \frac{\Delta v^2}{2} + \rho g \Delta h
  \]

#### 耦合方法的简化

- 简化：恒定的速度分布和平坦的几何形状
  \[
  U_{\text{hyd}} = \Delta p
  \]

#### 理想阻力

- 理想阻力由跨变量与通变量的比值给出
  \[
  R_{\text{hyd}} = \frac{U_{\text{hyd}}}{I_v} = \frac{\Delta p}{I_v} \leftrightarrow R_{\text{el}} = \frac{U}{I}
  \]

在流体力学中，类似于电阻的概念是流体阻力。电-流体动力学的类比有助于理解流体通过通道时的能量损失。通过简化模型，假设恒定的速度分布和平坦的几何形状，流体动力学势能的损失可以表示为压差 \(\Delta p\)。理想流体阻力由压差与体积流量的比值表示，与电阻的定义类似。

---

## P19

### 流体阻力

#### 泊肃叶（Poiseuille）流型的流体阻力（压力驱动的层流）：

\[
R_{\text{hyd}} = C_g \frac{\eta l}{A^2}
\]

其中，流体阻力与 \( \frac{1}{R^4} \) 成比例，并且依赖于通道几何形状（几何因子 \( C_g \)）。

#### 与管道中压力降的解析解比较

- **网络模拟**：
  \[
  \Delta p = C_g \frac{\eta l}{A^2} \cdot I_v
  \]

- **解析解**：
  \[
  \Delta p = \frac{8 \eta l}{\pi R^4} \cdot Q = \frac{8 \pi \eta l}{\pi R^2} \cdot Q
  \]

由此可以得出圆形通道的几何因子：

\[
C_{g, \text{circle}} = 8 \pi
\]

在压力驱动的层流（泊肃叶流）情况下，流体阻力与通道的几何形状有很大的关系。流体阻力公式中，几何因子 \( C_g \) 体现了这一点。通过网络模拟和解析解的对比，可以验证模型的准确性。在圆形管道中，几何因子 \( C_g \) 计算得出为 \( 8 \pi \)。

---

## P20

### 热阻

#### 电-热类比

- **电阻**：导体中的电压损失。
- **热阻**：导体中的温度损失。

#### 导热的建模方法

理想情况下，热阻由跨越变量与通过变量的比值表示：

\[
R_{\text{th}} = \frac{\Delta T}{I_{\text{th}}} \leftrightarrow R_{\text{el}} = \frac{U}{I}
\]

#### 平面墙壁的热阻

\[
R_{\text{th}} = \frac{\Delta T}{I_{\text{th}}} = \frac{d}{\lambda A}
\]

其中：
- \(\Delta T\) 是温差
- \(I_{\text{th}}\) 是热流
- \(d\) 是墙壁厚度
- \(\lambda\) 是热导率
- \(A\) 是墙壁的横截面积
  
热阻的概念与电阻相似，都是衡量某种物理量在通过介质时的损失。在导热的建模过程中，热阻表示为温差与热流的比值，对于平面墙壁的热阻，公式中包含了材料的厚度、热导率和横截面积。

---

## P21

### 流体电感

#### 电-流体动力学类比

- **电感**：导体中电流的变化会产生一个与该变化相反的电压。
- **流体动力学**：由于惯性，流体对外部力（如压力）的响应不是瞬时的。

#### 电感的建模方法

流体电感将压力与质量流量联系起来：

\[
d p_{\text{inertia}} = \frac{dF}{A} = \frac{d(m \cdot a)}{A} = \frac{\rho A \cdot d(x \cdot dv)}{dt \cdot A} = \rho \cdot \frac{dx}{A} \cdot \frac{d\dot{q}}{dt} = \rho \cdot \frac{dx}{A} \cdot \dot{q}
\]

电感决定了质量流量跟随压力变化的速度：

\[
L_{\text{hyd}} = \frac{\rho l}{A}
\]

\[
\Delta p_{\text{inertia}} = L_{\text{hyd}} \cdot \frac{d}{dt}\dot{q} \leftrightarrow u_{\text{ind}} = L_{\text{el}} \cdot \frac{d}{dt}i
\]

#### 解释

- **电感**：电感是指导体中电流变化时，电感元件会产生与该变化相反的电压，阻止电流的变化。
- **流体电感**：流体在管道中流动时，由于惯性，流体对外部压力的变化不会立即响应。流体电感表明流体质量流量（流速）跟随压力变化的速度。

通过上述公式可以看出，流体电感与流体的密度、管道长度以及截面积有关。类似于电感在电路中如何影响电流的变化，流体电感在流体动力学系统中决定了质量流量如何响应压力的变化。

---

## P22

### 流体电容

#### 电-流体动力学类比

- **电容**：由于电压差而存储电荷。
- **流体动力学**：由于压力差而存储流体体积。

#### 导致流体电容的现象

- **介质的可压缩性**：流体或气体在压力下的体积变化。
- **柔性墙和膜**：可以在压力变化下发生形变的结构。

#### 电容的建模方法

流体电容的表达式：

\[
C_{\text{hyd}} = -\frac{dV}{dp}
\]

#### 解释

- **电容**：在电学中，电容器存储电荷，电荷存储量与电压成正比。电容的大小决定了在一定电压下能够存储多少电荷。
- **流体电容**：在流体动力学中，流体电容表示在一定压力变化下，存储的流体体积变化量。类似于电容在电路中存储电荷的方式，流体电容存储流体体积。

具体来说，当有压力差存在时，流体电容决定了能够存储或释放的流体体积。这一现象可以通过流体的可压缩性以及系统中柔性结构（如柔性管壁和膜）的形变来实现。上述公式说明了流体电容是体积变化与压力变化的比值，即在压力变化的情况下，存储的流体体积如何变化。

---

## P23

### 热电容

#### 电-热类比

- **电容**：由于电压差而存储电荷。
- **热电容**：由于温度差而存储热量。

#### 热电容的建模方法

- **假设**：等温过程（即假设整个系统温度均匀）。
- 热电容的表达式：

\[
C_{\text{th}} = \frac{Q_{\text{th}}}{\Delta T} = V \rho c_p
\]

其中：
- \( Q_{\text{th}} \) 是存储的热量。
- \( \Delta T \) 是温差。
- \( V \) 是体积。
- \( \rho \) 是密度。
- \( c_p \) 是比热容。

#### 解释

- **电容**：在电学中，电容器在电压差下存储电荷，电容决定了在给定电压下能够存储的电荷量。
- **热电容**：在热力学中，热电容表示在温度差下存储的热量。类似于电容在电路中存储电荷，热电容在系统中存储热量。

具体来说，当存在温差时，热电容决定了存储或释放的热量。上述公式说明了热电容是热量与温差的比值，即在温度变化的情况下，存储的热量如何变化。热电容的大小由系统的体积、密度和比热容决定。

---

## P24

### 流体二极管（阀门）

#### 电-流体动力学类比

- **电二极管**：电流只能在一个方向上导通。
- **流体阀门**：流体只能在一个方向上流动。

#### 阀门的建模方法

包括流阻、电容和二极管特性：

1. **流量公式**：
   \[
   q = q_{\text{res}} + q_{\text{cap}} = q_{\text{res}} + C_{\text{hyd}} \frac{dp}{dt}
   \]

2. **反向操作**：
   \[
   q = 0 \quad \text{（反向操作时）}
   \]

#### 解释

- **电二极管**：在电路中，二极管允许电流仅在一个方向上通过，而在反方向则阻止电流。
- **流体阀门**：在流体系统中，阀门（类似于流体二极管）允许流体仅在一个方向上流动，而在反方向则阻止流动。

阀门的流量建模包括两部分：由于流阻引起的流量 \( q_{\text{res}} \) 和由于流体电容引起的流量 \( q_{\text{cap}} \)，其中流体电容部分可以表示为压力变化率的函数。当阀门处于反向操作时，流量 \( q \) 为零，表示流体无法通过阀门。

---

## P25

### 比较:计算流体动力学（CFD）和系统级网络模拟（system level network simulation）

#### CFD（计算流体动力学）

1. **基本原理**：
   - 基于物理场的偏微分方程系统（例如纳维-斯托克斯方程，NSE）。
   - 在空间和时间上是连续的。

2. **计算时间**：
   - 计算非常耗时。
   - 计算时间与网格尺寸和附加传输方程的数量有关（例如湍流、两相流的建模）。

3. **适用情况**：
   - 适用于研究组件内的分布变量（例如温度或压力）。
   - 适用于详细研究单个组件。

#### 系统级网络模拟

1. **基本原理**：
   - 基于网络元素传递函数的常微分方程系统。
   - 在空间上是离散的，但在时间上是连续的。

2. **计算时间**：
   - 计算速度快，即使是大系统也能快速计算。
   - 但无法提供空间分辨信息。

3. **适用情况**：
   - 适用于研究系统动态。
   - 适用于研究组件间的相互作用和耦合。

通过以上比较，可以看出CFD和系统级网络模拟在适用场景和计算效率上的差异。CFD适用于需要详细了解空间分布变量的情况，但计算耗时较长；而系统级网络模拟适用于需要快速了解系统动态和组件相互作用的情况，但不提供详细的空间分辨信息。

---

# Example

## P30

### Numerical solution for Hagen-Poiseuille flow

#### 流动的基本方程：
流动由纳维-斯托克斯方程（NSE）控制：
\[ \frac{\partial}{\partial t} (\rho \vec{v}) + \vec{v} \cdot \nabla (\rho \vec{v}) = -\nabla p + \nabla \cdot (\eta \nabla \vec{v}) + f_{\text{volume}} \]

#### 简化条件：
1. **二维描述**：可以在柱坐标系中对三维流场进行二维描述。
2. **稳定流**：假设流动是稳定的，不随时间变化。
3. **无外力**：假设没有外部作用力影响流动。
4. **完全发展**：假设流动已经完全发展。

#### 基本方程：
已简化的哈根-泊肃叶流动方程为：
\[ \frac{d^2 v}{dr^2} + \frac{1}{r} \frac{dv}{dr} + \frac{\Delta P}{\eta L} = 0 \]

#### 问题的一维化：
- **一维问题**：在径向 \( r \) 方向上分布 \( N \) 个节点。
- **节点数量**：\( N = 5 \) 个节点。

#### 离散化方案：
- **有限差分法**：使用有限差分方法对微分方程进行离散化。

#### 边界条件：
- 边界条件为：
\[ v_{i=0} = v_{i=4} = 0 \]

#### 有限差分法的基本原理：
基于微分商的定义：
\[ f'(x) = \lim_{h \to 0} \frac{f(x+h) - f(x)}{h} \]

#### 有限差分表达式：
1. **一阶前向差分**：
\[ \left( \frac{\partial f}{\partial x} \right)_i = \frac{f_{i+1} - f_i}{\Delta x} \]

2. **二阶中心差分**：
\[ \left( \frac{\partial^2 f}{\partial x^2} \right)_i = \frac{f_{i+1} - 2f_i + f_{i-1}}{\Delta x^2} \]

这些表达式是微分方程的近似解法，并且这些近似会带来一定的误差。

#### 泰勒展开：
对于 \( f(x + \Delta x) \) 的泰勒展开式：
\[ f(x + \Delta x) = f(x) + \Delta x \frac{df(x)}{dx} + \frac{\Delta x^2}{2} \frac{d^2 f(x)}{dx^2} + \cdots \]

从这个展开式中可以推导出：
\[ \frac{f(x+\Delta x) - f(x)}{\Delta x} = \frac{df(x)}{dx} + \frac{\Delta x}{2} \frac{d^2 f(x)}{dx^2} + \cdots \]

进一步整理得到：
\[ \frac{df(x)}{dx} = \frac{f(x+\Delta x) - f(x)}{\Delta x} - \frac{\Delta x}{2} \frac{d^2 f(x)}{dx^2} + \cdots \]

所以，有限差分的表达式实际上是包含了一个误差项 \( O(\Delta x) \)。

#### 有限差分的误差：
前向有限差分法的误差为 \( O(\Delta x) \)。

#### 提高精度的方法：
更精确或高阶的有限差分可以通过组合不同的泰勒展开式来获得，例如：
- 对于一阶中心差分：使用 \( f(x + \Delta x) \) 和 \( f(x - \Delta x) \)
- 对于二阶前向差分：使用 \( f(x + \Delta x) \) 和 \( f(x + 2\Delta x) \)

#### 基本方程：
在圆形通道中的泊肃叶流动微分方程（PDF）：
\[ r \cdot \frac{d^2 v}{dr^2} + \frac{dv}{dr} + r \cdot \frac{\Delta P}{\eta L} = 0 \]

#### 离散化：
对方程进行离散化处理：
\[ r_i \cdot \frac{v_{i+1} - 2v_i + v_{i-1}}{\Delta r^2} + \frac{v_{i+1} - v_i}{\Delta r} + r_i \cdot C = 0 \]
其中，C 是一个常数，表示 \(\frac{\Delta P}{\eta L}\)。

通过离散化，偏微分方程（PDE）转化为线性方程组。

#### 节点记号：
- **\( i = 0 \)**: \( v_0 = 0 \) （边界条件）
- **\( i = 1 \)**: \( r_1 \left( \frac{v_2 - 2v_1 + v_0}{\Delta r^2} \right) + \left( \frac{v_2 - v_1}{\Delta r} \right) + r_1 \cdot C = 0 \)
- **\( i = 2 \)**: \( r_2 \left( \frac{v_3 - 2v_2 + v_1}{\Delta r^2} \right) + \left( \frac{v_3 - v_2}{\Delta r} \right) + r_2 \cdot C = 0 \)
- **\( i = 3 \)**: \( r_3 \left( \frac{v_4 - 2v_3 + v_2}{\Delta r^2} \right) + \left( \frac{v_4 - v_3}{\Delta r} \right) + r_3 \cdot C = 0 \)
- **\( i = 4 \)**: \( v_4 = 0 \) （边界条件）

#### 矩阵表示法：
通过矩阵表示法将问题简化为线性方程组：
\[ 
A \cdot \vec{v} = \vec{b} 
\]
其中，矩阵 \( A \) 和向量 \( \vec{v} \) 表示为：
\[ 
A = \begin{pmatrix}
1 & 0 & 0 & 0 & 0 \\
-1 & 1 & 0 & 0 & 0 \\
0 & 0 & -1 & 1 & 0 \\
0 & 0 & 1 & -2 & 1 \\
0 & 0 & 0 & 0 & 1
\end{pmatrix}, 
\quad 
\vec{v} = \begin{pmatrix}
v_0 \\
v_1 \\
v_2 \\
v_3 \\
v_4
\end{pmatrix},
\quad 
\vec{b} = \begin{pmatrix}
0 \\
0.125 \\
0 \\
-0.125 \\
0
\end{pmatrix} 
\]

#### 线性方程组求解：
将线性方程组转化为可数值求解的形式：
\[ 
A \cdot \vec{v} = \vec{b} \quad \Rightarrow \quad \vec{v} = A^{-1} \vec{b} 
\]

#### 实际数值的代入：
- 管道半径 \( R = 100 \times 10^{-6} \, \text{m} \)
- 压差 \( \Delta P = 10000 \, \text{Pa} \)
- 管道长度 \( L = 10 \times 10^{-2} \, \text{m} \)
- 动力粘度 \( \eta = 0.001 \, \text{Pa} \cdot \text{s} \)
- 节点间距 \( \Delta R = 50 \times 10^{-6} \, \text{m} \)

#### 生成的线性方程组：
根据前述公式和这些实际数值，生成的线性方程组如下：

\[ 
A \cdot \vec{v} = \vec{b} 
\]

其中，
\[ 
A = \begin{pmatrix}
1 & 0 & 0 & 0 & 0 \\
-1 & 1 & 0 & 0 & 0 \\
0 & 0 & -1 & 1 & 0 \\
0 & 0 & 1 & -2 & 1 \\
0 & 0 & 0 & 0 & 1
\end{pmatrix}, 
\quad 
\vec{v} = \begin{pmatrix}
v_0 \\
v_1 \\
v_2 \\
v_3 \\
v_4
\end{pmatrix},
\quad 
\vec{b} = \begin{pmatrix}
0 \\
0.125 \\
0 \\
-0.125 \\
0
\end{pmatrix} 
\]

##E# 数值解在 \( i = 1 \) （节点1）处的计算：
使用之前的离散化公式计算节点1处的速度 \( v_1 \)：

\[ 
r_1 \left( \frac{v_2 - 2v_1 + v_0}{\Delta r^2} \right) + \left( \frac{v_2 - v_1}{\Delta r} \right) + r_1 C = 0 
\]

将具体数值代入：
\[ 
-50 \times 10^{-6} \, \text{m} \left( \frac{v_2 - 2v_1 + v_0}{(50 \times 10^{-6} \, \text{m})^2} \right) + \left( \frac{v_2 - v_1}{50 \times 10^{-6} \, \text{m}} \right) - 50 \times 10^{-6} \, \text{m} \cdot 10^8 \frac{1}{\text{m} \cdot \text{s}} = 0 
\]

进一步简化：
\[ 
\frac{-v_2 + 2v_1 - v_0}{50 \times 10^{-6} \, \text{m}} + \frac{v_2 - v_1}{50 \times 10^{-6} \, \text{m}} - 50 \times 10^{-6} \, \text{m} \cdot 10^8 \frac{1}{\text{m} \cdot \text{s}} = 0 
\]

得到：
\[ 
v_1 = 50 \times 10^{-6} \, \text{m} \cdot 50 \times 10^{-6} \, \text{m} \cdot 10^8 \frac{1}{\text{m} \cdot \text{s}} = 0.25 \frac{\text{m}}{\text{s}} 
\]

#### 解析解在 \( r = -50 \, \mu \text{m} \) （节点1）处的计算：
解析解公式：
\[ 
v_z(r) = \frac{\Delta P}{4 \eta L} (R^2 - r^2) 
\]

将具体数值代入：
\[ 
v_z(50 \, \mu \text{m}) = \frac{10000 \, \text{Pa}}{4 \cdot 0.001 \, \text{Pa} \cdot \text{s} \cdot 0.1 \, \text{m}} ( (100 \times 10^{-6} \, \text{m})^2 - (50 \times 10^{-6} \, \text{m})^2 ) 
\]

进一步计算：
\[ 
v_z(50 \, \mu \text{m}) = \frac{10000}{0.4} \cdot (10000 - 2500) \times 10^{-12} \, \text{m}^2 = 0.1875 \frac{\text{m}}{\text{s}} 
\]

#### 对比数值解与解析解：
通过对比数值解和解析解，可以验证数值方法的准确性。数值解在节点1处的速度为 \( 0.25 \frac{\text{m}}{\text{s}} \)，解析解在相同位置的速度为 \( 0.1875 \frac{\text{m}}{\text{s}} \)。虽然有些许差异，但整体趋势和数量级是一致的，验证了数值解的合理性。

#### 数值解与解析解对比：
- 在 \( r = -50 \, \mu \text{m} \) （节点1）处的解：
  - 解析解：\( 0.1875 \, \frac{\text{m}}{\text{s}} \)
  - 数值解：\( 0.25 \, \frac{\text{m}}{\text{s}} \)

#### 结果差异的原因：
##### 数值误差：
1. **粗网格使用**：只用了5个节点（N=5），网格较粗。
2. **使用前向差分**：
   - 前向差分法存在 \( O(\Delta x) \) 量级的误差，这会导致计算结果不够精确。

#### 图示说明：
右侧的图表显示了径向位置上的速度分布对比：
- **蓝色曲线**：解析解
- **橙色曲线**：使用5个节点的数值解

可以看到，数值解在节点处与解析解有一定的偏差，尤其是在径向距离较大的区域。这表明，尽管数值解能够大致反映流动的趋势，但由于使用了较粗的网格和前向差分法，导致了较大的误差。

#### 模拟结果质量的依赖因素：
1. **网格质量**：
   - 网格越细，数值解的精度通常越高。
   - 使用更细密的网格可以减少数值误差。

2. **离散化方法的质量**：
   - 离散化方法的选择会影响数值解的精度。
   - 高阶离散化方法可以减少误差。

#### 图示说明：
右侧图表显示了不同节点数情况下径向速度分布的对比：
- **蓝色曲线**：解析解
- **橙色曲线**：5个节点的数值解
- **绿色曲线**：9个节点的数值解
- **紫色曲线**：11个节点的数值解
- **红色曲线**：19个节点的数值解
- **黄色曲线**：31个节点的数值解
- **青色曲线**：201个节点的数值解

#### 观察与分析：
- 可以看到，随着节点数增加，数值解逐渐接近解析解。
- 使用较少节点时，数值解偏离解析解较大，尤其在流速变化较大的区域。
- 使用较多节点时，数值解与解析解的差异减小，曲线更平滑，显示出更高的精度。

#### 结论与建议：
- **模拟结果的可靠性**：依赖于网格的细密程度和离散化方法的精度。
- **验证与校准**：在依赖模拟结果时，必须检查基础假设和实现细节，确保结果的可靠性。

#### 提示：
- 在实际应用中，选择合适的网格密度和平衡计算成本与精度是关键。
- 使用更高阶的离散化方法可以显著提高模拟结果的精度。

---

## P40

### 2. Response time of a microfluidic channel

#### 问题描述：
在微流控通道中，当压力突然增加时，流速 \( q(t) \) 的时间依赖行为是什么？

#### 参数：
- **通道类型**：圆形通道
  - 半径 \( r = 400 \, \mu \text{m} \)
  - 长度 \( l = 10 \, \text{mm} \)
- **流体密度**：\( \rho = 1000 \, \text{kg/m}^3 \)
- **动态粘度**：\( \eta = 0.001 \, \text{Pa} \cdot \text{s} \)
- **压差**：\( \Delta p = 100 \, \text{Pa} \) （在 \( t \ge 0 \) 时）

#### 假设：
- **刚性壁**：假设通道壁是刚性的，不会变形。

#### 模型方法：
将通道用网络模拟方法建模。

#### 常微分方程（ODE）：
\[ \Delta p(t) = \Delta p_{\text{inertia}} + \Delta p_{\text{viscous}} = L_{\text{hyd}} \dot{q}(t) + R_{\text{hyd}} q(t) \]

- \( \Delta p(t) \)：时间 \( t \) 处的压力变化
- \( \Delta p_{\text{inertia}} \)：惯性压差
- \( \Delta p_{\text{viscous}} \)：粘性压差
- \( L_{\text{hyd}} \)：液压电感，表示流体的惯性
- \( R_{\text{hyd}} \)：液压电阻，表示流体的粘性阻力
- \( \dot{q}(t) \)：流速的时间导数

#### 解决ODE：
- 这个ODE是一个一阶非齐次线性微分方程。
- 可以通过常数变易法或参数变易法来求解。

#### 求解齐次ODE：
1. 从齐次方程开始：
\[ 0 = L \frac{dq(t)}{dt} + R q(t) \]

2. 分离变量并积分：
\[ -\frac{R}{L} dt = \frac{dq(t)}{q(t)} \]
\[ q(t) = c \cdot e^{-\frac{R}{L} t} \]

#### 使常数变量化：
1. 将常数 \( c \) 变量化：
\[ q(t) = c(t) \cdot e^{-\frac{R}{L} t} \]

2. 将这个形式代入原方程：
\[ \Delta p = L \left( -\frac{R}{L} c(t) \cdot e^{-\frac{R}{L} t} + L \frac{dc(t)}{dt} \cdot e^{-\frac{R}{L} t} + R \cdot c(t) \cdot e^{-\frac{R}{L} t} \right) \]
\[ \Delta p = L \frac{dc(t)}{dt} \cdot e^{-\frac{R}{L} t} \]

#### 求解 \( c(t) \)：
1. 从之前的方程出发：
\[ \Delta p = L \cdot \frac{dc(t)}{dt} \cdot e^{-\frac{R}{L} t} \]
\[ \frac{\Delta p}{L} e^{\frac{R}{L} t} dt = dc(t) \]

2. 对两边积分：
\[ c(t) = \frac{\Delta p}{L} \cdot \frac{L}{R} \cdot e^{\frac{R}{L} t} + d = \frac{\Delta p}{R} \cdot e^{\frac{R}{L} t} + d \]

#### 重新代入：
1. 将 \( c(t) \) 代入 \( q(t) \) 的表达式：
\[ q(t) = \left( \frac{\Delta p}{R} \cdot e^{\frac{R}{L} t} + d \right) \cdot e^{-\frac{R}{L} t} \]

2. 使用初始条件 \( q(0) = 0 \) 确定常数 \( d \)：
\[ q(0) = 0 \Rightarrow d = -\frac{\Delta p}{R} \]

3. 得到流速随时间的表达式：
\[ q(t) = \left( \frac{\Delta p}{R} \cdot e^{\frac{R}{L} t} - \frac{\Delta p}{R} \right) \cdot e^{-\frac{R}{L} t} \]
\[ q(t) = \frac{\Delta p}{R} \left( 1 - e^{-\frac{t}{\tau}} \right) \]
其中，\(\tau = \frac{L_{\text{hyd}}}{R_{\text{hyd}}}\)

#### 解的表达式：
\[ q(t) = \frac{\Delta p}{R_{\text{hyd}}} \left( 1 - e^{-\frac{t}{\tau}} \right) \]
- 特征响应时间 \(\tau\)：
\[ \tau = \frac{L_{\text{hyd}}}{R_{\text{hyd}}} = 0.02 \, \text{s} \]

